{
  "coda": {
    "stats": true
  },
  "secrets": {
    "url": "https://api.ipify.org?format=json"
  },
  "operations": {
    "uptime": {
      "entrypoint": true,
      "action": "os.exec",
      "params": {
        "command": "/usr/bin/uptime",
        "arguments": []
      },
      "onSuccess": "http.ip",
      "async": false,
      "store": "exec"
    },

    "http.ip": {
      "action": "http.request",
      "params": {
        "url": "${secrets.url}",
        "method": "GET"
      },
      "onSuccess": "store",
      "store": "http"
    },

    "store": {
      "action": "string",
      "params": {
        "value": "${store.http.body.ip | sha512}"
      },
      "store": "http"
    }
  }
}
